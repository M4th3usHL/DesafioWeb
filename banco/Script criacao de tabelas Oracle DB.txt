-- Tabela Funcionários
CREATE TABLE FUNCIONARIO (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOME_COMPLETO VARCHAR2(100 CHAR) NOT NULL,
    POSICAO VARCHAR2(50 CHAR) NOT NULL,
    ANIVERSARIO DATE,
    TELEFONE VARCHAR2(20 CHAR),
    EMAIL VARCHAR2(200 CHAR),
    SALARIO NUMBER(12,2)
);

-- Para email não repetir
CREATE UNIQUE INDEX UIDX_FUNCIONARIO_EMAIL_CI ON FUNCIONARIO (LOWER(EMAIL));

-- Tabela Cursos
-- Um funcionário pode ter vários

CREATE TABLE CURSOS (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    FUNCIONARIO_ID NUMBER NOT NULL,
    NOME VARCHAR2(100 CHAR) NOT NULL,
    INSTITUICAO VARCHAR2(100 CHAR),
    DATA_CONCLUSAO DATE,
    CONSTRAINT FK_CURSOS_EMP FOREIGN KEY (FUNCIONARIO_ID) REFERENCES FUNCIONARIO(ID) ON DELETE CASCADE
);

-- Tabela Endereço
-- Um Funcionário pode ter vários

CREATE TABLE ENDERECO (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    FUNCIONARIO_ID NUMBER NOT NULL,
    RUA VARCHAR2(150 CHAR),
    CIDADE VARCHAR2(100 CHAR),
    ESTADO VARCHAR2(50 CHAR),
    CEP VARCHAR2(20 CHAR),
    CONSTRAINT FK_ENDERECO_EMP FOREIGN KEY (FUNCIONARIO_ID) REFERENCES FUNCIONARIO(ID) ON DELETE CASCADE
);

-- Tabela Documentos

CREATE TABLE DOCUMENTOS (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    FUNCIONARIO_ID NUMBER NOT NULL,
    DOC_TIPO VARCHAR2(50 CHAR) NOT NULL,   -- Ex.: CPF, RG, CNH, CTPS
    DOC_NUMERO VARCHAR2(100 CHAR) NOT NULL,
    DATA_EMISSAO DATE,
    DATA_EXPIRA DATE,
    CONSTRAINT FK_DOCUMENTO_EMP FOREIGN KEY (FUNCIONARIO_ID) REFERENCES FUNCIONARIO(ID) ON DELETE CASCADE,
    CONSTRAINT UQ_DOC_EMP_TYPE UNIQUE (FUNCIONARIO_ID, DOC_TIPO) -- não repetir mesmo tipo para o mesmo funcionário
);

-- CPF único no sistema
CREATE UNIQUE INDEX UIDX_DOC_NUMERO_UNICO ON DOCUMENTOs (DOC_NUMERO);

